<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title></title>
	<!-- stylesheets -->
	<link rel="stylesheet" href="treant-js-master/Treant.css" type="text/css"/>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
	<link rel="stylesheet" href="https://unpkg.com/treeflex/dist/css/treeflex.css">
</head>
<body>
	 <form action="/tree" method="get"> 
		<input type="text" id="equation" name="q" value="">
  		<input type="submit" value="Submit">
	</form>
	

	<div class="tf-tree">
	  <ul>
		<li id="tree-here">
		  
		</li>
	  </ul>
	</div>


	{% for i in range(0,nTrees) %}
		<div id="tree-simple{{ i }}" style="width:800px; height: 400px"> </div>
	{% endfor %}
	<!-- javascript -->
	<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
	<script src="treant-js-master/vendor/raphael.js"></script>
	<script src="treant-js-master/Treant.js"></script>
	<script>
			{{ tree | safe}}
			nodes = {};
			nodes["node0"] = {text:"Node 0",parent:""};
			nodes["node1"] = {text:"Node 1",parent:"node0"};
			nodes["node2"] = {text:"Node 2",parent:"node0"};
			allNodes = ["node0","node1","node2"];
			var jsonTree = {};
			for (var i=0;i<allNodes.length;i++){
				var name = allNodes[i];
				var text = nodes[name].text;
				var children = [];
				var parent = nodes[name].parent;
				var node = document.createElement('li');
				var span = document.createElement('span');
				span.classList.add("tf-nc");
				span.textContent = text;
				node.appendChild(span);
				
				
				jsonTree[name]={text:text,children:children,node:node};
				if (parent != ""){
					jsonTree[parent].children.push(name);
					var pnode = jsonTree[parent].node;
					if (pnode.querySelector('ul')){
						pnode.querySelector('ul').appendChild(node);
					}
					else {
						var ul = document.createElement('ul');
						pnode.appendChild(ul);
						pnode.querySelector('ul').appendChild(node);
					}
					
				}
				else{
					document.getElementById('tree-here').appendChild(node);
				}
				
			}
		    /*config = {
				container: "#tree-simple"
			};
			node14 = {
			text: { name: "###^*##*+#?+#?+@0_1_2_3_4_5_6_" }
			};
			node3 = {
			parent: node14,
			text: { name: "###^*@0_1_2_" }
			};

			simple_chart_config = [
				config, node14, node3,
			];
			var chart = new Treant(simple_chart_config );*/
	</script>
	<script>
		var katexElements = document.querySelectorAll('div.node');
		for (var i=0;i<katexElements.length;i++){
			var el = katexElements[i];
			katex.render(el.textContent, el, {
				throwOnError: false
			});
		}
	</script>
</body>
</html>