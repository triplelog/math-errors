<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.72.0">
    <title>Dashboard Template Â· Bootstrap</title>

    <link rel="canonical" href="">

    

    <!-- Bootstrap core CSS -->
<link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
	<link rel="stylesheet" href="css/treeflex.css">

    <style>

      
    </style>

    
    <!-- Custom styles for this template -->
    <link href="css/dashboard.css" rel="stylesheet">
    <link href="css/output.css" rel="stylesheet">
  </head>
  <body>
    

<div class="flex m-0 p-0">
    
	  <div class="w-1/5 flex-none bg-blue-200 min-h-screen">
		<div class="w-full morsebg text-white py-2 text-center text-2xl">
			<a>Math Errors</a>
		</div>

		<ul class="nav flex-column">
		  <li class="nav-item">
			<a class="nav-link active" aria-current="page" href="#">
			  <span data-feather="plus"></span>
			  New Question
			</a>
		  </li>
	  
		</ul>
		<h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
		  <span>History</span>
		</h6>
		<h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
		  <span>Topics</span>
		  <a class="link-secondary" href="#" aria-label="Add a new report">
			<span data-feather="plus-circle"></span>
		  </a>
		</h6>
		<ul class="mx-2 w-full">
		  {% for subject in subjects %}
		  <li class="my-3 uppercase">
			<a class="uppercase" href="#">
			  {{ subject.subject }}
			</a>
			<ul class="mx-2">
				{% for name, list in subject.topics %}
				<li class="my-1 capitalize">
					<span>{{ name }}</span>
					<button class="float-right bg-green-500 hover:bg-green-700 text-white font-bold py-0 px-1 rounded focus:outline-none focus:shadow-outline" type="button">?</button>
					<ul class="mx-2">
						{% for item in list %}
						<li class="my-1 capitalize">
							<a href="createrule?s={{subject.subject}}&t={{name}}&r={{item.name}}">{{ item.name }}</a>
							<button class="float-right bg-green-500 hover:bg-green-700 text-white font-bold py-0 px-1 rounded focus:outline-none focus:shadow-outline" type="button">?</button>
						</li>
						{% endfor %}
					</ul>
				</li>
				{% endfor %}
			</ul>
		  </li>
		  {% endfor %}
		  
		</ul>
	  </div>


    <div class="w-4/5 flex-none px-2 max-h-screen overflow-y-auto">
        <div class="w-full mb-2 py-4">
			<span class="text-2xl"><b>Create Rule</b></span>
			<button class="float-right bg-white hover:border-gray-900 text-gray-700 font-bold py-2 px-2 border border-gray-400 rounded-r focus:outline-none focus:shadow-outline" type="button">Share</button>
			<button class="float-right bg-transparent hover:bg-gray-200 text-gray-700 font-bold py-2 px-2 border border-gray-400 focus:outline-none focus:shadow-outline" type="button">Export</button>
			<button class="float-right bg-transparent hover:bg-gray-200 text-gray-700 font-bold py-2 px-2 border border-gray-400 rounded-l focus:outline-none focus:shadow-outline" type="button">Import</button>
					
        </div>

		<div class="flex flex-wrap w-full">
		  <div class="w-full sm:w-1/1 md:w-1/2 lg:w-1/2 mb-4 px-2">
			  <div class="w-full bg-gray-200 border border-gray-300 px-2 py-2 rounded-t">
				<b>Info</b>
				<button onclick="saveRule()" class="float-right bg-blue-500 hover:bg-blue-700 text-white font-bold py-0 px-2 rounded focus:outline-none focus:shadow-outline" type="button">Save</button>

			  </div>
			  <div class="w-full bg-white border border-gray-300 px-2 py-2 rounded-b">
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="subtop">
						Subject.Topic
					  </label>
					  <input id="subtop" value="{% if info.subtop %}{{ info.subtop }}{% endif %}" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="name">
						Name
					  </label>
					  <input id="name" value="{% if info.name %}{{ info.name }}{% endif %}" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="exp">
						Explanation
					  </label>
						<textarea rows="3" id="exp" value="{% if info.explanation %}{{ info.explanation }}{% endif %}" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3 mr-2" ></textarea>
					  
				</div>
				
			  </div>
		  </div>
		  <div class="w-full sm:w-1/1 md:w-1/2 lg:w-1/2 mb-4 px-2">
			  <div class="w-full bg-gray-200 border border-gray-300 px-2 py-2 rounded-t">
				<b>Correct</b>
			  </div>
			  <div class="w-full bg-white border border-gray-300 px-2 py-2 rounded-b">
			  	<div>
			  		<div id="instructionsC"></div>
			  		<template id="instructionTemplate">
			  			<div class="flex w-full my-1">
			  				<button type="button" class="flex-initial mr-2"><i data-feather="trash-2"></i></button><span class="flex-grow"></span>
			  			</div>
			  		</template>
			  	</div>
			  	
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="inC">
						In
					  </label>
					  <input id="inC" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="outC">
						Out
					  </label>
					  <input id="outC" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<div id="constraintsC"></div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="addConC">
						Constraints
					  </label>
					  <div class="w-full flex">
						<input id="addConC" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded flex-grow py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3 mr-2" type="text">
						<button onclick="addConC()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex-none focus:outline-none focus:shadow-outline mb-3" type="button">Add Constraint</button>
					  </div>
				</div>
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="expC">
						Explanation
					  </label>
					  <textarea rows="2" id="expC" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3"></textarea>

				</div>
				<div>
					<button onclick="addInstructionC()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex-none focus:outline-none focus:shadow-outline mb-3" type="button">Add Instruction</button>
				</div>

			  </div>
		  </div>
		  <div class="w-full sm:w-1/1 md:w-1/2 lg:w-1/2 mb-4 px-2">
			  <div class="w-full bg-gray-200 border border-gray-300 px-2 py-2 rounded-t">
				<b>Error</b>
			  </div>
			  <div class="w-full bg-white border border-gray-300 px-2 py-2 rounded-b">
			  	<div>
			  		<div id="instructionsE"></div>
			  	</div>
			  	
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="inE">
						In
					  </label>
					  <input id="inE" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="outE">
						Out
					  </label>
					  <input id="outE" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<div id="constraintsE"></div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="addConE">
						Constraints
					  </label>
					  <div class="w-full flex">
						<input id="addConE" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded flex-grow py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3 mr-2" type="text">
						<button onclick="addConE()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex-none focus:outline-none focus:shadow-outline mb-3" type="button">Add Constraint</button>
					  </div>
				</div>
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="expE">
						Explanation
					  </label>
					  <textarea rows="2" id="expE" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3"></textarea>

				</div>
				<div>
					<button onclick="addInstructionE()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex-none focus:outline-none focus:shadow-outline mb-3" type="button">Add Instruction</button>
				</div>

			  </div>
		  </div>
		  <div class="w-full sm:w-1/1 md:w-1/2 lg:w-1/2 mb-4 px-2">
			  <div class="w-full bg-gray-200 border border-gray-300 px-2 py-2 rounded-t">
				<b>Examples</b>
			  </div>
			  <div class="w-full bg-white border border-gray-300 px-2 py-2 rounded-b">
			  	<div>
			  		<div id="instructionsX"></div>
			  	</div>
			  	
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="inX">
						In
					  </label>
					  <input id="inX" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<label class="block text-gray-700 text-sm font-bold mb-1" for="outX">
						Out
					  </label>
					  <input id="outX" class="bg-gray-100 appearance-none border-2 border-gray-400 rounded w-full py-2 px-2 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 mb-3" type="text">

				</div>
				<div>
					<button onclick="addInstructionX()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex-none focus:outline-none focus:shadow-outline mb-3" type="button">Add Example</button>
				</div>

			  </div>
		  </div>
		</div>

		

    </div>

</div>


    <script src="../assets/dist/js/bootstrap.bundle.min.js"></script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.24.1/feather.min.js" integrity="sha384-EbSscX4STvYAC/DxHse8z5gEDaNiKAIGW+EpfzYTfQrgIlHywXXrM9SUIZ0BlyfF" crossorigin="anonymous"></script>
      <script src="js/dashboard.js"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>

	<script>
		ws = new WebSocket('wss://matherrors.com:8081');
		ws.onopen = function(evt) {
			//var jsonmessage = {'type':'soloKey'};
			//jsonmessage.message = tkey;
			//ws.send(JSON.stringify(jsonmessage));
			
		}
		ws.onmessage = function(evt){
			var dm = JSON.parse(evt.data);
			console.log(dm);
			if (dm.type == 'answer'){
				createTrees(dm.answer);
			}
			else if (dm.type == 'preview'){
				document.getElementById("previewQ").innerHTML = "";
				document.getElementById("previewQ").textContent = dm.preview;
			}
			
			
		}

		var instructions = [];
		var correct = {{ correct | dump |safe }};
		var errors = {{ errors | dump |safe }};
		var examples = {{ examples | dump |safe }};
		for (var i=0;i<correct.length;i++){
			instructions.push(correct[i]);
			var template = document.querySelector('#instructionTemplate');
			var clone = template.content.cloneNode(true);
			clone.querySelector('span').textContent = correct[i];
			clone.querySelector('button').addEventListener('click',deleteInstruction);
			document.getElementById('instructionsC').appendChild(clone);
		}
		for (var i=0;i<errors.length;i++){
			instructions.push(errors[i]);
			var template = document.querySelector('#instructionTemplate');
			var clone = template.content.cloneNode(true);
			clone.querySelector('span').textContent = errors[i];
			clone.querySelector('button').addEventListener('click',deleteInstruction);
			document.getElementById('instructionsE').appendChild(clone);
		}
		for (var i=0;i<examples.length;i++){
			instructions.push(examples[i]);
			var template = document.querySelector('#instructionTemplate');
			var clone = template.content.cloneNode(true);
			clone.querySelector('span').textContent = examples[i];
			clone.querySelector('button').addEventListener('click',deleteInstruction);
			document.getElementById('instructionsX').appendChild(clone);
		}
		function saveRule() {
			var subtop = document.getElementById("subtop").value;
			var subject = subtop.split(".")[0];
			var topic = subtop.split(".")[1];
			var name = document.getElementById('name').value;
			var explanation = document.getElementById('exp').value;
			

			var jsonmessage = {type:"saveRule",subject:subject,topic:topic,name:name,explanation:explanation,instructions:instructions};
			ws.send(JSON.stringify(jsonmessage));
		}
		function deleteRule() {
			var subtop = document.getElementById("subtop").value;
			var subject = subtop.split(".")[0];
			var topic = subtop.split(".")[1];
			var name = document.getElementById('name').value;
			var explanation = document.getElementById('exp').value;
			

			var jsonmessage = {type:"deleteRule",subject:subject,topic:topic,name:name};
			ws.send(JSON.stringify(jsonmessage));
		}
		var conC = [];
		var conE = [];
		function addConC() {
			var el = document.getElementById('addConC');
			conC.push(el.value);
			document.getElementById('constraintsC').textContent += "\n"+el.value;
			el.value = "";
		}
		function addConE() {
			var el = document.getElementById('addConE');
			conE.push(el.value);
			document.getElementById('constraintsE').textContent += "\n"+el.value;
			el.value = "";
		}
		function deleteInstruction(evt) {
			var el = evt.target.parentElement;
			while (el.tagName != "DIV" && el.parentElement){
				el = el.parentElement;
			}
			var instruction = el.querySelector('span').textContent;
			for (var i=0;i<instructions.length;i++){
				if (instructions[i] == instruction){
					instructions.splice(i,1);
					el.parentNode.removeChild(el);
					break;
				}
			}
		}
		function addInstructionC() {
			var explanation = document.getElementById('expC').value;
			var inText = document.getElementById('inC').value;
			var outText = document.getElementById('outC').value;
			var instruction = inText+","+outText+",c,"+explanation;
			for (var i=0;i<conC.length;i++){
				instruction += ","+conC[i];
			}
			instructions.push(instruction);
			var template = document.querySelector('#instructionTemplate');
			var clone = template.content.cloneNode(true);
			clone.querySelector('span').textContent = instruction;
			clone.querySelector('button').addEventListener('click',deleteInstruction);
			document.getElementById('instructionsC').appendChild(clone);
			document.getElementById('constraintsC').textContent = "";
			conC = [];
			document.getElementById('expC').value = "";
			document.getElementById('inC').value = "";
			document.getElementById('outC').value = "";
			document.getElementById('addConC').value = "";
			feather.replace();
		}
		function addInstructionE() {
			var explanation = document.getElementById('expE').value;
			var inText = document.getElementById('inE').value;
			var outText = document.getElementById('outE').value;
			var instruction = inText+","+outText+",e,"+explanation;
			for (var i=0;i<conE.length;i++){
				instruction += ","+conE[i];
			}
			instructions.push(instruction);
			var template = document.querySelector('#instructionTemplate');
			var clone = template.content.cloneNode(true);
			clone.querySelector('span').textContent = instruction;
			clone.querySelector('button').addEventListener('click',deleteInstruction);
			document.getElementById('instructionsE').appendChild(clone);
			document.getElementById('constraintsE').textContent = "";
			conE = [];
			document.getElementById('expE').value = "";
			document.getElementById('inE').value = "";
			document.getElementById('outE').value = "";
			document.getElementById('addConE').value = "";
			feather.replace();
		}
		function addInstructionX() {
			var inText = document.getElementById('inX').value;
			var outText = document.getElementById('outX').value;
			var instruction = inText+","+outText+",x,";
			instructions.push(instruction);
			var template = document.querySelector('#instructionTemplate');
			var clone = template.content.cloneNode(true);
			clone.querySelector('span').textContent = instruction;
			clone.querySelector('button').addEventListener('click',deleteInstruction);
			document.getElementById('instructionsX').appendChild(clone);
			document.getElementById('inX').value = "";
			document.getElementById('outX').value = "";
			feather.replace();
		}
		feather.replace();
		
		
		
	</script>
  </body>
</html>
